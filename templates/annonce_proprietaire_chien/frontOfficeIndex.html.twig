{% extends 'base.html.twig' %}

{% block title %}Mating Dogs{% endblock %}



{% block body %}

<div class="sidebar-search">
    <div class="input-group custom-search-form" style="padding-top:7%">
        <input type="text" id="search" class="form-control" placeholder="Search for a mate">
    </div>
    <!-- /input-group -->
</div>

    <div id="blog" class="blog">
        <div class="container">
            <div class="row" id="entitiesNav">
                {% for annonce_proprietaire_chien in annonce_proprietaire_chiens %}

                    <div class="col-lg-3 show-up wow fadeInUp" data-wow-duration="1s" data-wow-delay="0.3s">
                        <div class="blog-post">
                            <div class="thumb">

                                <a href="#"><img src="{{asset('FrontOffice/uploads/'~annonce_proprietaire_chien.idchien.image) }}" alt=""></a>
                            </div>
                            <div class="down-content">
                                <span class="category">{{ annonce_proprietaire_chien.idchien.sexe }}</span>

                                <a href="#"><h4>{{ annonce_proprietaire_chien.idchien.nom }}</h4></a>
                                <p>
                                    {{ annonce_proprietaire_chien.idchien.age }}</p>

                            </div>
                        </div>
                    </div>




                {% endfor %}

            </div>
        </div>
    </div>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

    <script type="text/javascript">
        jQuery(document).ready(function() {
            var searchRequest = null;
            $("#search").keyup(function() {
                var minlength = 0;
                var that = this;
                    var value = $(this).val();
                    var entitySelector = $("#entitiesNav").html('');
                    if (value.length >= minlength ) {
                        if (searchRequest != null)
                            searchRequest.abort();
                        searchRequest = $.ajax({
                        type: "GET",
                        url: "{{ path('mating_ajax_search') }}",
                        data: {
                            'm' : value
                        },
                        dataType: "text",
                        success: function(msg){
                            //we need to check if the value is the same
                            if (value==$(that).val()) {
                                var result = JSON.parse(msg);
                                $.each(result, function(key, arr) {
                                    $.each(arr, function(id, value) {
                                        if (key == 'annonces') {
                                            if (id != 'error') {
                                                entitySelector.append(' <div class="col-lg-3 show-up wow fadeInUp" data-wow-duration="1s" data-wow-delay="0.3s">' +
                                                    ' <div class="blog-post"> <div class="thumb"><a><img src="/FrontOffice/uploads/'+value[3]+'" alt=""> </a> </div> <div class="down-content"> <span class="category">'+value[0]+' </span> ' +
                                                    '<a href="#"><h4>'+ value[2]+'</h4></a> <p>'+value[1]+' </p> </div></div> </div>');
                                            } else {
                                                entitySelector.append('<li class="errorLi">'+value+'</li>');
                                            }
                                        }
                                    });
                                });
                            }
                        }
                    });
                }
            });
        });
    </script>
{% endblock %}
